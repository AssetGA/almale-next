"use strict";(()=>{var e={};e.id=485,e.ids=[485],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},396:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>L,requestAsyncStorage:()=>x,routeModule:()=>g,serverHooks:()=>h,staticGenerationAsyncStorage:()=>y});var n={};r.r(n),r.d(n,{POST:()=>m});var a=r(9303),s=r(8716),o=r(670),i=r(7070),p=r(7446),u=r(6590),d=r.n(u),l=r(9702),c=r.n(l);async function m(e){await (0,p.P)();try{let{userId:t,productId:r,deliveryPrice:n,quantity:a,total:s}=await e.json();console.log("userId",t);let o=await d().findById(t);if(null!==o)try{let e=await c().create({productId:r,deliveryPrice:n,quantity:a,total:s,userId:t});return console.log("newOrder",e),i.NextResponse.json({content:"send"},{status:200})}catch(e){return i.NextResponse.json({message:"falseUser"},{status:400})}}catch(e){return i.NextResponse.json({message:"На сервере произошла ошибка попробуйте позже"},{status:500})}}let g=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/order/route",pathname:"/api/order",filename:"route",bundlePath:"app/api/order/route"},resolvedPagePath:"/home/asset/projects/almale/almale-next/src/app/api/order/route.js",nextConfigOutput:"",userland:n}),{requestAsyncStorage:x,staticGenerationAsyncStorage:y,serverHooks:h}=g,v="/api/order/route";function L(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:y})}},7446:(e,t,r)=>{r.d(t,{P:()=>o});var n=r(1185),a=r.n(n);let s=!1,o=async()=>{if(a().set("strictQuery",!0),s){console.log("DB connected already");return}try{await a().connect(process.env.MONGODB_URI,{dbName:"test"}),s=!0}catch(e){console.log(e)}}},9702:(e,t,r)=>{let{Schema:n,model:a,models:s}=r(1185),o=new n({productId:{type:String,maxLength:50},deliveryPrice:{type:Number,maxLength:20},quantity:{type:Number,maxLength:5},total:{type:Number,maxLength:20},userId:{type:String,maxLength:40}},{timestamps:!0}),i=s.Order||a("Order",o);e.exports=i},6590:(e,t,r)=>{let{Schema:n,model:a,models:s}=r(1185),o=new n({name:{type:String,required:!0,minLength:3,maxLength:100},mobile:{type:String,required:!0,maxLength:30},street:{type:String,maxLength:100},city:{type:String,maxLength:200},postalCode:{type:String,maxLength:20},email:{type:String,maxLength:200,required:!0}},{timestamps:!0}),i=s.Users||a("Users",o);e.exports=i}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972],()=>r(396));module.exports=n})();