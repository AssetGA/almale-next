/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/lib/api/chat/route";
exports.ids = ["app/lib/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

"use strict";
module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

"use strict";
module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

"use strict";
module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Flib%2Fapi%2Fchat%2Froute&page=%2Flib%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Flib%2Fapi%2Fchat%2Froute.js&appDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Flib%2Fapi%2Fchat%2Froute&page=%2Flib%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Flib%2Fapi%2Fchat%2Froute.js&appDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_asset_projects_almale_almale_next_src_app_lib_api_chat_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/lib/api/chat/route.js */ \"(rsc)/./src/app/lib/api/chat/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"standalone\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/lib/api/chat/route\",\n        pathname: \"/lib/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/lib/api/chat/route\"\n    },\n    resolvedPagePath: \"/home/asset/projects/almale/almale-next/src/app/lib/api/chat/route.js\",\n    nextConfigOutput,\n    userland: _home_asset_projects_almale_almale_next_src_app_lib_api_chat_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZsaWIlMkZhcGklMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZsaWIlMkZhcGklMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGbGliJTJGYXBpJTJGY2hhdCUyRnJvdXRlLmpzJmFwcERpcj0lMkZob21lJTJGYXNzZXQlMkZwcm9qZWN0cyUyRmFsbWFsZSUyRmFsbWFsZS1uZXh0JTJGc3JjJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZob21lJTJGYXNzZXQlMkZwcm9qZWN0cyUyRmFsbWFsZSUyRmFsbWFsZS1uZXh0JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PXN0YW5kYWxvbmUmcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDcUI7QUFDbEc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9ob21lL2Fzc2V0L3Byb2plY3RzL2FsbWFsZS9hbG1hbGUtbmV4dC9zcmMvYXBwL2xpYi9hcGkvY2hhdC9yb3V0ZS5qc1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJzdGFuZGFsb25lXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvbGliL2FwaS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9saWIvYXBpL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvbGliL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL2hvbWUvYXNzZXQvcHJvamVjdHMvYWxtYWxlL2FsbWFsZS1uZXh0L3NyYy9hcHAvbGliL2FwaS9jaGF0L3JvdXRlLmpzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgd29ya0FzeW5jU3RvcmFnZSxcbiAgICAgICAgd29ya1VuaXRBc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Flib%2Fapi%2Fchat%2Froute&page=%2Flib%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Flib%2Fapi%2Fchat%2Froute.js&appDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/lib/api/chat/route.js":
/*!***************************************!*\
  !*** ./src/app/lib/api/chat/route.js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _utils_bot_openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/bot/openai */ \"(rsc)/./src/app/utils/bot/openai.js\");\n\n\n// 🧠 Базовый контекст консультанта\nconst SYSTEM_PROMPT = `\nТы — профессиональный консультант по продаже медной посуды бренда **Alma'le**.  \nОтвечай дружелюбно, красиво и уверенно, как будто разговариваешь с клиентом в магазине.  \n\nИспользуй только достоверные факты с сайта [https://alma-le.com](https://alma-le.com) и информации о бренде в YouTube.  \nЕсли не уверен в ответе — объясни, что уточнишь, но не выдумывай.\n\n🔸 Твоя задача:\n- Помогать покупателю выбрать посуду Alma'le, подчеркивая её преимущества и уникальность.\n- Говорить убедительно, но без давления.\n- Делать упор на **качество, долговечность, эстетику, пользу для здоровья**.\n- Подчеркивать, что набор идеально подходит в подарок для мамы или жены.\n- Упоминать, что **цена набора — 395 000 ₸** (по курсу Национального банка РК).\n- Уточнять, что **доставка по всему миру**, возможна **оплата криптовалютой**, **доставка оплачивается отдельно**.\n- При вопросе о рассрочке говорить, что можно оформить **в Каспи магазине Alma'le**.\n\n💬 Пример ответов:\n- “Эта медная кастрюля не только красивая, но и сохраняет вкус и аромат блюд. Она прослужит десятилетия.”\n- “Да, конечно! Мы доставляем по всему миру — от Алматы до Парижа.”\n- “Набор за 395 000 ₸ — идеальный подарок, особенно если вы хотите подчеркнуть заботу и внимание.”\n\n📦 При ответе всегда помни: твоя цель — заинтересовать покупателя и вызвать желание купить или узнать больше.\n`;\n// 🗨️ Контекст диалога (хранится в памяти, можно заменить на Redis при желании)\nconst INITIAL_SESSION = {\n    messages: [\n        {\n            role: \"system\",\n            content: SYSTEM_PROMPT\n        }\n    ]\n};\n// 🔤 Маппинг языков\nconst LANGUAGE_LABELS = {\n    kz: \"Ответь на казахском языке, используя естественные и дружелюбные выражения.\",\n    ru: \"Ответь на русском языке, дружелюбно и уверенно.\",\n    en: \"Answer in English, warmly and professionally.\"\n};\nasync function POST(request) {\n    try {\n        const { message, lang, name, phone } = await request.json();\n        console.log(\"lang\", lang);\n        if (!message || message.trim() === \"\") {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: \"Пустое сообщение не может быть обработано.\"\n            }, {\n                status: 400\n            });\n        }\n        if (!lang || ![\n            \"ru\",\n            \"kz\",\n            \"en\"\n        ].includes(lang)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: \"Неверно указан язык (должен быть ru, kz или en).\"\n            }, {\n                status: 400\n            });\n        }\n        // 🗨️ Добавляем сообщение пользователя с инструкцией по языку\n        INITIAL_SESSION.messages.push({\n            role: \"user\",\n            content: `${LANGUAGE_LABELS[lang]}\\nСообщение: \"${message}\"`\n        });\n        // Обрезаем историю — оставляем, например, 12 последних сообщений (включая system)\n        if (INITIAL_SESSION.messages.length > 20) {\n            // оставим system + последние 10\n            const system = INITIAL_SESSION.messages[0];\n            const tail = INITIAL_SESSION.messages.slice(-10);\n            INITIAL_SESSION.messages = [\n                system,\n                ...tail\n            ];\n        }\n        // Отправляем запрос к OpenAI\n        const completion = await _utils_bot_openai__WEBPACK_IMPORTED_MODULE_1__.openai.chat(INITIAL_SESSION.messages);\n        console.log(\"0000\", completion);\n        INITIAL_SESSION.messages.push({\n            role: _utils_bot_openai__WEBPACK_IMPORTED_MODULE_1__.openai.roles.ASSISTANT,\n            content: completion\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            reply: completion\n        }, {\n            status: 200\n        });\n    } catch (error) {\n        console.error(\"Ошибка AI:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: \"Произошла ошибка при обработке запроса.\"\n        }, {\n            status: 500\n        });\n    }\n}\n// Handle CORS preflight\nfunction OPTIONS() {\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"GET, POST, OPTIONS, PUT, PATCH, DELETE\",\n            \"Access-Control-Allow-Headers\": \"Origin, X-Requested-With, Content-Type, Accept\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2xpYi9hcGkvY2hhdC9yb3V0ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTJDO0FBQ1E7QUFFbkQsbUNBQW1DO0FBQ25DLE1BQU1FLGdCQUFnQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBc0J2QixDQUFDO0FBRUQsZ0ZBQWdGO0FBQ2hGLE1BQU1DLGtCQUFrQjtJQUN0QkMsVUFBVTtRQUFDO1lBQUVDLE1BQU07WUFBVUMsU0FBU0o7UUFBYztLQUFFO0FBQ3hEO0FBRUEsb0JBQW9CO0FBQ3BCLE1BQU1LLGtCQUFrQjtJQUN0QkMsSUFBSTtJQUNKQyxJQUFJO0lBQ0pDLElBQUk7QUFDTjtBQUVPLGVBQWVDLEtBQUtDLE9BQU87SUFDaEMsSUFBSTtRQUNGLE1BQU0sRUFBRUMsT0FBTyxFQUFFQyxJQUFJLEVBQUVDLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTUosUUFBUUssSUFBSTtRQUN6REMsUUFBUUMsR0FBRyxDQUFDLFFBQVFMO1FBQ3BCLElBQUksQ0FBQ0QsV0FBV0EsUUFBUU8sSUFBSSxPQUFPLElBQUk7WUFDckMsT0FBT3BCLHFEQUFZQSxDQUFDaUIsSUFBSSxDQUN0QjtnQkFBRUosU0FBUztZQUE2QyxHQUN4RDtnQkFBRVEsUUFBUTtZQUFJO1FBRWxCO1FBRUEsSUFBSSxDQUFDUCxRQUFRLENBQUM7WUFBQztZQUFNO1lBQU07U0FBSyxDQUFDUSxRQUFRLENBQUNSLE9BQU87WUFDL0MsT0FBT2QscURBQVlBLENBQUNpQixJQUFJLENBQ3RCO2dCQUFFSixTQUFTO1lBQW1ELEdBQzlEO2dCQUFFUSxRQUFRO1lBQUk7UUFFbEI7UUFFQSw4REFBOEQ7UUFDOURsQixnQkFBZ0JDLFFBQVEsQ0FBQ21CLElBQUksQ0FBQztZQUM1QmxCLE1BQU07WUFDTkMsU0FBUyxHQUFHQyxlQUFlLENBQUNPLEtBQUssQ0FBQyxjQUFjLEVBQUVELFFBQVEsQ0FBQyxDQUFDO1FBQzlEO1FBRUEsa0ZBQWtGO1FBQ2xGLElBQUlWLGdCQUFnQkMsUUFBUSxDQUFDb0IsTUFBTSxHQUFHLElBQUk7WUFDeEMsZ0NBQWdDO1lBQ2hDLE1BQU1DLFNBQVN0QixnQkFBZ0JDLFFBQVEsQ0FBQyxFQUFFO1lBQzFDLE1BQU1zQixPQUFPdkIsZ0JBQWdCQyxRQUFRLENBQUN1QixLQUFLLENBQUMsQ0FBQztZQUM3Q3hCLGdCQUFnQkMsUUFBUSxHQUFHO2dCQUFDcUI7bUJBQVdDO2FBQUs7UUFDOUM7UUFFQSw2QkFBNkI7UUFDN0IsTUFBTUUsYUFBYSxNQUFNM0IscURBQU1BLENBQUM0QixJQUFJLENBQUMxQixnQkFBZ0JDLFFBQVE7UUFDN0RjLFFBQVFDLEdBQUcsQ0FBQyxRQUFRUztRQUNwQnpCLGdCQUFnQkMsUUFBUSxDQUFDbUIsSUFBSSxDQUFDO1lBQzVCbEIsTUFBTUoscURBQU1BLENBQUM2QixLQUFLLENBQUNDLFNBQVM7WUFDNUJ6QixTQUFTc0I7UUFDWDtRQUVBLE9BQU81QixxREFBWUEsQ0FBQ2lCLElBQUksQ0FBQztZQUFFZSxPQUFPSjtRQUFXLEdBQUc7WUFBRVAsUUFBUTtRQUFJO0lBQ2hFLEVBQUUsT0FBT1ksT0FBTztRQUNkZixRQUFRZSxLQUFLLENBQUMsY0FBY0E7UUFDNUIsT0FBT2pDLHFEQUFZQSxDQUFDaUIsSUFBSSxDQUN0QjtZQUFFSixTQUFTO1FBQTBDLEdBQ3JEO1lBQUVRLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRUEsd0JBQXdCO0FBQ2pCLFNBQVNhO0lBQ2QsT0FBT2xDLHFEQUFZQSxDQUFDaUIsSUFBSSxDQUFDLE1BQU07UUFDN0JJLFFBQVE7UUFDUmMsU0FBUztZQUNQLCtCQUErQjtZQUMvQixnQ0FBZ0M7WUFDaEMsZ0NBQ0U7UUFDSjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9ob21lL2Fzc2V0L3Byb2plY3RzL2FsbWFsZS9hbG1hbGUtbmV4dC9zcmMvYXBwL2xpYi9hcGkvY2hhdC9yb3V0ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tIFwibmV4dC9zZXJ2ZXJcIjtcbmltcG9ydCB7IG9wZW5haSB9IGZyb20gXCIuLi8uLi8uLi91dGlscy9ib3Qvb3BlbmFpXCI7XG5cbi8vIPCfp6Ag0JHQsNC30L7QstGL0Lkg0LrQvtC90YLQtdC60YHRgiDQutC+0L3RgdGD0LvRjNGC0LDQvdGC0LBcbmNvbnN0IFNZU1RFTV9QUk9NUFQgPSBgXG7QotGLIOKAlCDQv9GA0L7RhNC10YHRgdC40L7QvdCw0LvRjNC90YvQuSDQutC+0L3RgdGD0LvRjNGC0LDQvdGCINC/0L4g0L/RgNC+0LTQsNC20LUg0LzQtdC00L3QvtC5INC/0L7RgdGD0LTRiyDQsdGA0LXQvdC00LAgKipBbG1hJ2xlKiouICBcbtCe0YLQstC10YfQsNC5INC00YDRg9C20LXQu9GO0LHQvdC+LCDQutGA0LDRgdC40LLQviDQuCDRg9Cy0LXRgNC10L3QvdC+LCDQutCw0Log0LHRg9C00YLQviDRgNCw0LfQs9C+0LLQsNGA0LjQstCw0LXRiNGMINGBINC60LvQuNC10L3RgtC+0Lwg0LIg0LzQsNCz0LDQt9C40L3QtS4gIFxuXG7QmNGB0L/QvtC70YzQt9GD0Lkg0YLQvtC70YzQutC+INC00L7RgdGC0L7QstC10YDQvdGL0LUg0YTQsNC60YLRiyDRgSDRgdCw0LnRgtCwIFtodHRwczovL2FsbWEtbGUuY29tXShodHRwczovL2FsbWEtbGUuY29tKSDQuCDQuNC90YTQvtGA0LzQsNGG0LjQuCDQviDQsdGA0LXQvdC00LUg0LIgWW91VHViZS4gIFxu0JXRgdC70Lgg0L3QtSDRg9Cy0LXRgNC10L0g0LIg0L7RgtCy0LXRgtC1IOKAlCDQvtCx0YrRj9GB0L3QuCwg0YfRgtC+INGD0YLQvtGH0L3QuNGI0YwsINC90L4g0L3QtSDQstGL0LTRg9C80YvQstCw0LkuXG5cbvCflLgg0KLQstC+0Y8g0LfQsNC00LDRh9CwOlxuLSDQn9C+0LzQvtCz0LDRgtGMINC/0L7QutGD0L/QsNGC0LXQu9GOINCy0YvQsdGA0LDRgtGMINC/0L7RgdGD0LTRgyBBbG1hJ2xlLCDQv9C+0LTRh9C10YDQutC40LLQsNGPINC10ZEg0L/RgNC10LjQvNGD0YnQtdGB0YLQstCwINC4INGD0L3QuNC60LDQu9GM0L3QvtGB0YLRjC5cbi0g0JPQvtCy0L7RgNC40YLRjCDRg9Cx0LXQtNC40YLQtdC70YzQvdC+LCDQvdC+INCx0LXQtyDQtNCw0LLQu9C10L3QuNGPLlxuLSDQlNC10LvQsNGC0Ywg0YPQv9C+0YAg0L3QsCAqKtC60LDRh9C10YHRgtCy0L4sINC00L7Qu9Cz0L7QstC10YfQvdC+0YHRgtGMLCDRjdGB0YLQtdGC0LjQutGDLCDQv9C+0LvRjNC30YMg0LTQu9GPINC30LTQvtGA0L7QstGM0Y8qKi5cbi0g0J/QvtC00YfQtdGA0LrQuNCy0LDRgtGMLCDRh9GC0L4g0L3QsNCx0L7RgCDQuNC00LXQsNC70YzQvdC+INC/0L7QtNGF0L7QtNC40YIg0LIg0L/QvtC00LDRgNC+0Log0LTQu9GPINC80LDQvNGLINC40LvQuCDQttC10L3Riy5cbi0g0KPQv9C+0LzQuNC90LDRgtGMLCDRh9GC0L4gKirRhtC10L3QsCDQvdCw0LHQvtGA0LAg4oCUIDM5NSAwMDAg4oK4KiogKNC/0L4g0LrRg9GA0YHRgyDQndCw0YbQuNC+0L3QsNC70YzQvdC+0LPQviDQsdCw0L3QutCwINCg0JopLlxuLSDQo9GC0L7Rh9C90Y/RgtGMLCDRh9GC0L4gKirQtNC+0YHRgtCw0LLQutCwINC/0L4g0LLRgdC10LzRgyDQvNC40YDRgyoqLCDQstC+0LfQvNC+0LbQvdCwICoq0L7Qv9C70LDRgtCwINC60YDQuNC/0YLQvtCy0LDQu9GO0YLQvtC5KiosICoq0LTQvtGB0YLQsNCy0LrQsCDQvtC/0LvQsNGH0LjQstCw0LXRgtGB0Y8g0L7RgtC00LXQu9GM0L3QvioqLlxuLSDQn9GA0Lgg0LLQvtC/0YDQvtGB0LUg0L4g0YDQsNGB0YHRgNC+0YfQutC1INCz0L7QstC+0YDQuNGC0YwsINGH0YLQviDQvNC+0LbQvdC+INC+0YTQvtGA0LzQuNGC0YwgKirQsiDQmtCw0YHQv9C4INC80LDQs9Cw0LfQuNC90LUgQWxtYSdsZSoqLlxuXG7wn5KsINCf0YDQuNC80LXRgCDQvtGC0LLQtdGC0L7Qsjpcbi0g4oCc0K3RgtCwINC80LXQtNC90LDRjyDQutCw0YHRgtGA0Y7Qu9GPINC90LUg0YLQvtC70YzQutC+INC60YDQsNGB0LjQstCw0Y8sINC90L4g0Lgg0YHQvtGF0YDQsNC90Y/QtdGCINCy0LrRg9GBINC4INCw0YDQvtC80LDRgiDQsdC70Y7QtC4g0J7QvdCwINC/0YDQvtGB0LvRg9C20LjRgiDQtNC10YHRj9GC0LjQu9C10YLQuNGPLuKAnVxuLSDigJzQlNCwLCDQutC+0L3QtdGH0L3QviEg0JzRiyDQtNC+0YHRgtCw0LLQu9GP0LXQvCDQv9C+INCy0YHQtdC80YMg0LzQuNGA0YMg4oCUINC+0YIg0JDQu9C80LDRgtGLINC00L4g0J/QsNGA0LjQttCwLuKAnVxuLSDigJzQndCw0LHQvtGAINC30LAgMzk1IDAwMCDigrgg4oCUINC40LTQtdCw0LvRjNC90YvQuSDQv9C+0LTQsNGA0L7Quiwg0L7RgdC+0LHQtdC90L3QviDQtdGB0LvQuCDQstGLINGF0L7RgtC40YLQtSDQv9C+0LTRh9C10YDQutC90YPRgtGMINC30LDQsdC+0YLRgyDQuCDQstC90LjQvNCw0L3QuNC1LuKAnVxuXG7wn5OmINCf0YDQuCDQvtGC0LLQtdGC0LUg0LLRgdC10LPQtNCwINC/0L7QvNC90Lg6INGC0LLQvtGPINGG0LXQu9GMIOKAlCDQt9Cw0LjQvdGC0LXRgNC10YHQvtCy0LDRgtGMINC/0L7QutGD0L/QsNGC0LXQu9GPINC4INCy0YvQt9Cy0LDRgtGMINC20LXQu9Cw0L3QuNC1INC60YPQv9C40YLRjCDQuNC70Lgg0YPQt9C90LDRgtGMINCx0L7Qu9GM0YjQtS5cbmA7XG5cbi8vIPCfl6jvuI8g0JrQvtC90YLQtdC60YHRgiDQtNC40LDQu9C+0LPQsCAo0YXRgNCw0L3QuNGC0YHRjyDQsiDQv9Cw0LzRj9GC0LgsINC80L7QttC90L4g0LfQsNC80LXQvdC40YLRjCDQvdCwIFJlZGlzINC/0YDQuCDQttC10LvQsNC90LjQuClcbmNvbnN0IElOSVRJQUxfU0VTU0lPTiA9IHtcbiAgbWVzc2FnZXM6IFt7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQ6IFNZU1RFTV9QUk9NUFQgfV0sXG59O1xuXG4vLyDwn5SkINCc0LDQv9C/0LjQvdCzINGP0LfRi9C60L7QslxuY29uc3QgTEFOR1VBR0VfTEFCRUxTID0ge1xuICBrejogXCLQntGC0LLQtdGC0Ywg0L3QsCDQutCw0LfQsNGF0YHQutC+0Lwg0Y/Qt9GL0LrQtSwg0LjRgdC/0L7Qu9GM0LfRg9GPINC10YHRgtC10YHRgtCy0LXQvdC90YvQtSDQuCDQtNGA0YPQttC10LvRjtCx0L3Ri9C1INCy0YvRgNCw0LbQtdC90LjRjy5cIixcbiAgcnU6IFwi0J7RgtCy0LXRgtGMINC90LAg0YDRg9GB0YHQutC+0Lwg0Y/Qt9GL0LrQtSwg0LTRgNGD0LbQtdC70Y7QsdC90L4g0Lgg0YPQstC10YDQtdC90L3Qvi5cIixcbiAgZW46IFwiQW5zd2VyIGluIEVuZ2xpc2gsIHdhcm1seSBhbmQgcHJvZmVzc2lvbmFsbHkuXCIsXG59O1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlLCBsYW5nLCBuYW1lLCBwaG9uZSB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2coXCJsYW5nXCIsIGxhbmcpO1xuICAgIGlmICghbWVzc2FnZSB8fCBtZXNzYWdlLnRyaW0oKSA9PT0gXCJcIikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IG1lc3NhZ2U6IFwi0J/Rg9GB0YLQvtC1INGB0L7QvtCx0YnQtdC90LjQtSDQvdC1INC80L7QttC10YIg0LHRi9GC0Ywg0L7QsdGA0LDQsdC+0YLQsNC90L4uXCIgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghbGFuZyB8fCAhW1wicnVcIiwgXCJrelwiLCBcImVuXCJdLmluY2x1ZGVzKGxhbmcpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgbWVzc2FnZTogXCLQndC10LLQtdGA0L3QviDRg9C60LDQt9Cw0L0g0Y/Qt9GL0LogKNC00L7Qu9C20LXQvSDQsdGL0YLRjCBydSwga3og0LjQu9C4IGVuKS5cIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8g8J+XqO+4jyDQlNC+0LHQsNCy0LvRj9C10Lwg0YHQvtC+0LHRidC10L3QuNC1INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjyDRgSDQuNC90YHRgtGA0YPQutGG0LjQtdC5INC/0L4g0Y/Qt9GL0LrRg1xuICAgIElOSVRJQUxfU0VTU0lPTi5tZXNzYWdlcy5wdXNoKHtcbiAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgY29udGVudDogYCR7TEFOR1VBR0VfTEFCRUxTW2xhbmddfVxcbtCh0L7QvtCx0YnQtdC90LjQtTogXCIke21lc3NhZ2V9XCJgLFxuICAgIH0pO1xuXG4gICAgLy8g0J7QsdGA0LXQt9Cw0LXQvCDQuNGB0YLQvtGA0LjRjiDigJQg0L7RgdGC0LDQstC70Y/QtdC8LCDQvdCw0L/RgNC40LzQtdGALCAxMiDQv9C+0YHQu9C10LTQvdC40YUg0YHQvtC+0LHRidC10L3QuNC5ICjQstC60LvRjtGH0LDRjyBzeXN0ZW0pXG4gICAgaWYgKElOSVRJQUxfU0VTU0lPTi5tZXNzYWdlcy5sZW5ndGggPiAyMCkge1xuICAgICAgLy8g0L7RgdGC0LDQstC40Lwgc3lzdGVtICsg0L/QvtGB0LvQtdC00L3QuNC1IDEwXG4gICAgICBjb25zdCBzeXN0ZW0gPSBJTklUSUFMX1NFU1NJT04ubWVzc2FnZXNbMF07XG4gICAgICBjb25zdCB0YWlsID0gSU5JVElBTF9TRVNTSU9OLm1lc3NhZ2VzLnNsaWNlKC0xMCk7XG4gICAgICBJTklUSUFMX1NFU1NJT04ubWVzc2FnZXMgPSBbc3lzdGVtLCAuLi50YWlsXTtcbiAgICB9XG5cbiAgICAvLyDQntGC0L/RgNCw0LLQu9GP0LXQvCDQt9Cw0L/RgNC+0YEg0LogT3BlbkFJXG4gICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IG9wZW5haS5jaGF0KElOSVRJQUxfU0VTU0lPTi5tZXNzYWdlcyk7XG4gICAgY29uc29sZS5sb2coXCIwMDAwXCIsIGNvbXBsZXRpb24pO1xuICAgIElOSVRJQUxfU0VTU0lPTi5tZXNzYWdlcy5wdXNoKHtcbiAgICAgIHJvbGU6IG9wZW5haS5yb2xlcy5BU1NJU1RBTlQsXG4gICAgICBjb250ZW50OiBjb21wbGV0aW9uLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgcmVwbHk6IGNvbXBsZXRpb24gfSwgeyBzdGF0dXM6IDIwMCB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwi0J7RiNC40LHQutCwIEFJOlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBtZXNzYWdlOiBcItCf0YDQvtC40LfQvtGI0LvQsCDQvtGI0LjQsdC60LAg0L/RgNC4INC+0LHRgNCw0LHQvtGC0LrQtSDQt9Cw0L/RgNC+0YHQsC5cIiB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBIYW5kbGUgQ09SUyBwcmVmbGlnaHRcbmV4cG9ydCBmdW5jdGlvbiBPUFRJT05TKCkge1xuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24obnVsbCwge1xuICAgIHN0YXR1czogMjAwLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luXCI6IFwiKlwiLFxuICAgICAgXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1NZXRob2RzXCI6IFwiR0VULCBQT1NULCBPUFRJT05TLCBQVVQsIFBBVENILCBERUxFVEVcIixcbiAgICAgIFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiOlxuICAgICAgICBcIk9yaWdpbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgQ29udGVudC1UeXBlLCBBY2NlcHRcIixcbiAgICB9LFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJvcGVuYWkiLCJTWVNURU1fUFJPTVBUIiwiSU5JVElBTF9TRVNTSU9OIiwibWVzc2FnZXMiLCJyb2xlIiwiY29udGVudCIsIkxBTkdVQUdFX0xBQkVMUyIsImt6IiwicnUiLCJlbiIsIlBPU1QiLCJyZXF1ZXN0IiwibWVzc2FnZSIsImxhbmciLCJuYW1lIiwicGhvbmUiLCJqc29uIiwiY29uc29sZSIsImxvZyIsInRyaW0iLCJzdGF0dXMiLCJpbmNsdWRlcyIsInB1c2giLCJsZW5ndGgiLCJzeXN0ZW0iLCJ0YWlsIiwic2xpY2UiLCJjb21wbGV0aW9uIiwiY2hhdCIsInJvbGVzIiwiQVNTSVNUQU5UIiwicmVwbHkiLCJlcnJvciIsIk9QVElPTlMiLCJoZWFkZXJzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/lib/api/chat/route.js\n");

/***/ }),

/***/ "(rsc)/./src/app/utils/bot/openai.js":
/*!*************************************!*\
  !*** ./src/app/utils/bot/openai.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   openai: () => (/* binding */ openai)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n\n\nclass OpenAID {\n    constructor(){\n        this.roles = {\n            ASSISTANT: \"assistant\",\n            USER: \"user\",\n            SYSTEM: \"system\"\n        };\n        this.openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n            apiKey: process.env.OPENAI_API_KEY\n        }, {\n            timeout: 120000\n        });\n    }\n    async chat(messages) {\n        try {\n            const completion = await this.openai.chat.completions.create({\n                messages: messages,\n                model: \"gpt-4o-mini\",\n                temperature: 0.9,\n                store: true\n            });\n            const reply = completion.choices?.[0]?.message?.content ?? \"Извините, не получил ответ от модели.\";\n            return reply;\n        } catch (error) {\n            console.log(\"Error while chat\", error.message);\n        }\n    }\n    async transcription(filepath) {\n        try {\n            // Проверка существования файла\n            if (!(0,fs__WEBPACK_IMPORTED_MODULE_0__.existsSync)(filepath)) {\n                throw new Error(`File not found: ${filepath}`);\n            }\n            const fileStream = (0,fs__WEBPACK_IMPORTED_MODULE_0__.createReadStream)(filepath);\n            const response = await this.openai.audio.transcriptions.create({\n                file: fileStream,\n                model: \"whisper-1\"\n            });\n            return response.text;\n        } catch (e) {\n            console.error(\"Error during transcription:\", e.message);\n            console.error(\"Статус ошибки:\", e.status);\n            console.error(\"Full error:\", e);\n            throw new Error(\"Transcription failed. Please check the logs for more details.\");\n        }\n    }\n}\nconst openai = new OpenAID();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL3V0aWxzL2JvdC9vcGVuYWkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFrRDtBQUN0QjtBQUU1QixNQUFNRztJQU1KQyxhQUFjO2FBTGRDLFFBQVE7WUFDTkMsV0FBVztZQUNYQyxNQUFNO1lBQ05DLFFBQVE7UUFDVjtRQUVFLElBQUksQ0FBQ0MsTUFBTSxHQUFHLElBQUlQLDhDQUFNQSxDQUN0QjtZQUNFUSxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGNBQWM7UUFDcEMsR0FDQTtZQUNFQyxTQUFTO1FBQ1g7SUFFSjtJQUNBLE1BQU1DLEtBQUtDLFFBQVEsRUFBRTtRQUNuQixJQUFJO1lBQ0YsTUFBTUMsYUFBYSxNQUFNLElBQUksQ0FBQ1IsTUFBTSxDQUFDTSxJQUFJLENBQUNHLFdBQVcsQ0FBQ0MsTUFBTSxDQUFDO2dCQUMzREgsVUFBVUE7Z0JBQ1ZJLE9BQU87Z0JBQ1BDLGFBQWE7Z0JBQ2JDLE9BQU87WUFDVDtZQUNBLE1BQU1DLFFBQ0pOLFdBQVdPLE9BQU8sRUFBRSxDQUFDLEVBQUUsRUFBRUMsU0FBU0MsV0FDbEM7WUFFRixPQUFPSDtRQUNULEVBQUUsT0FBT0ksT0FBTztZQUNkQyxRQUFRQyxHQUFHLENBQUMsb0JBQW9CRixNQUFNRixPQUFPO1FBQy9DO0lBQ0Y7SUFDQSxNQUFNSyxjQUFjQyxRQUFRLEVBQUU7UUFDNUIsSUFBSTtZQUNGLCtCQUErQjtZQUMvQixJQUFJLENBQUM5Qiw4Q0FBVUEsQ0FBQzhCLFdBQVc7Z0JBQ3pCLE1BQU0sSUFBSUMsTUFBTSxDQUFDLGdCQUFnQixFQUFFRCxVQUFVO1lBQy9DO1lBQ0EsTUFBTUUsYUFBYWpDLG9EQUFnQkEsQ0FBQytCO1lBRXBDLE1BQU1HLFdBQVcsTUFBTSxJQUFJLENBQUN6QixNQUFNLENBQUMwQixLQUFLLENBQUNDLGNBQWMsQ0FBQ2pCLE1BQU0sQ0FBQztnQkFDN0RrQixNQUFNSjtnQkFDTmIsT0FBTztZQUNUO1lBRUEsT0FBT2MsU0FBU0ksSUFBSTtRQUN0QixFQUFFLE9BQU9DLEdBQUc7WUFDVlgsUUFBUUQsS0FBSyxDQUFDLCtCQUErQlksRUFBRWQsT0FBTztZQUN0REcsUUFBUUQsS0FBSyxDQUFDLGtCQUFrQlksRUFBRUMsTUFBTTtZQUN4Q1osUUFBUUQsS0FBSyxDQUFDLGVBQWVZO1lBQzdCLE1BQU0sSUFBSVAsTUFDUjtRQUVKO0lBQ0Y7QUFDRjtBQUVPLE1BQU12QixTQUFTLElBQUlOLFVBQVUiLCJzb3VyY2VzIjpbIi9ob21lL2Fzc2V0L3Byb2plY3RzL2FsbWFsZS9hbG1hbGUtbmV4dC9zcmMvYXBwL3V0aWxzL2JvdC9vcGVuYWkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlUmVhZFN0cmVhbSwgZXhpc3RzU3luYyB9IGZyb20gXCJmc1wiO1xuaW1wb3J0IE9wZW5BSSBmcm9tIFwib3BlbmFpXCI7XG5cbmNsYXNzIE9wZW5BSUQge1xuICByb2xlcyA9IHtcbiAgICBBU1NJU1RBTlQ6IFwiYXNzaXN0YW50XCIsXG4gICAgVVNFUjogXCJ1c2VyXCIsXG4gICAgU1lTVEVNOiBcInN5c3RlbVwiLFxuICB9O1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLm9wZW5haSA9IG5ldyBPcGVuQUkoXG4gICAgICB7XG4gICAgICAgIGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0aW1lb3V0OiAxMjAwMDAsIC8vINCj0LLQtdC70LjRh9C10L3QuNC1INGC0LDQudC80LDRg9GC0LAg0LTQviAyINC80LjQvdGD0YJcbiAgICAgIH1cbiAgICApO1xuICB9XG4gIGFzeW5jIGNoYXQobWVzc2FnZXMpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29tcGxldGlvbiA9IGF3YWl0IHRoaXMub3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgICAgbWVzc2FnZXM6IG1lc3NhZ2VzLFxuICAgICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC45LFxuICAgICAgICBzdG9yZTogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgcmVwbHkgPVxuICAgICAgICBjb21wbGV0aW9uLmNob2ljZXM/LlswXT8ubWVzc2FnZT8uY29udGVudCA/P1xuICAgICAgICBcItCY0LfQstC40L3QuNGC0LUsINC90LUg0L/QvtC70YPRh9C40Lsg0L7RgtCy0LXRgiDQvtGCINC80L7QtNC10LvQuC5cIjtcblxuICAgICAgcmV0dXJuIHJlcGx5O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkVycm9yIHdoaWxlIGNoYXRcIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuICB9XG4gIGFzeW5jIHRyYW5zY3JpcHRpb24oZmlsZXBhdGgpIHtcbiAgICB0cnkge1xuICAgICAgLy8g0J/RgNC+0LLQtdGA0LrQsCDRgdGD0YnQtdGB0YLQstC+0LLQsNC90LjRjyDRhNCw0LnQu9CwXG4gICAgICBpZiAoIWV4aXN0c1N5bmMoZmlsZXBhdGgpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmlsZSBub3QgZm91bmQ6ICR7ZmlsZXBhdGh9YCk7XG4gICAgICB9XG4gICAgICBjb25zdCBmaWxlU3RyZWFtID0gY3JlYXRlUmVhZFN0cmVhbShmaWxlcGF0aCk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5vcGVuYWkuYXVkaW8udHJhbnNjcmlwdGlvbnMuY3JlYXRlKHtcbiAgICAgICAgZmlsZTogZmlsZVN0cmVhbSxcbiAgICAgICAgbW9kZWw6IFwid2hpc3Blci0xXCIsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQ7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGR1cmluZyB0cmFuc2NyaXB0aW9uOlwiLCBlLm1lc3NhZ2UpO1xuICAgICAgY29uc29sZS5lcnJvcihcItCh0YLQsNGC0YPRgSDQvtGI0LjQsdC60Lg6XCIsIGUuc3RhdHVzKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGdWxsIGVycm9yOlwiLCBlKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgXCJUcmFuc2NyaXB0aW9uIGZhaWxlZC4gUGxlYXNlIGNoZWNrIHRoZSBsb2dzIGZvciBtb3JlIGRldGFpbHMuXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBvcGVuYWkgPSBuZXcgT3BlbkFJRCgpO1xuIl0sIm5hbWVzIjpbImNyZWF0ZVJlYWRTdHJlYW0iLCJleGlzdHNTeW5jIiwiT3BlbkFJIiwiT3BlbkFJRCIsImNvbnN0cnVjdG9yIiwicm9sZXMiLCJBU1NJU1RBTlQiLCJVU0VSIiwiU1lTVEVNIiwib3BlbmFpIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwidGltZW91dCIsImNoYXQiLCJtZXNzYWdlcyIsImNvbXBsZXRpb24iLCJjb21wbGV0aW9ucyIsImNyZWF0ZSIsIm1vZGVsIiwidGVtcGVyYXR1cmUiLCJzdG9yZSIsInJlcGx5IiwiY2hvaWNlcyIsIm1lc3NhZ2UiLCJjb250ZW50IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwidHJhbnNjcmlwdGlvbiIsImZpbGVwYXRoIiwiRXJyb3IiLCJmaWxlU3RyZWFtIiwicmVzcG9uc2UiLCJhdWRpbyIsInRyYW5zY3JpcHRpb25zIiwiZmlsZSIsInRleHQiLCJlIiwic3RhdHVzIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/utils/bot/openai.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/ms","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/agentkeepalive","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Flib%2Fapi%2Fchat%2Froute&page=%2Flib%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Flib%2Fapi%2Fchat%2Froute.js&appDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fasset%2Fprojects%2Falmale%2Falmale-next&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=standalone&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();