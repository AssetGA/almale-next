(()=>{var e={};e.id=7087,e.ids=[7087],e.modules={56037:e=>{"use strict";e.exports=require("mongoose")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},29021:e=>{"use strict";e.exports=require("fs")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},33873:e=>{"use strict";e.exports=require("path")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},4573:e=>{"use strict";e.exports=require("node:buffer")},77598:e=>{"use strict";e.exports=require("node:crypto")},73024:e=>{"use strict";e.exports=require("node:fs")},57075:e=>{"use strict";e.exports=require("node:stream")},37830:e=>{"use strict";e.exports=require("node:stream/web")},57975:e=>{"use strict";e.exports=require("node:util")},68271:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>h,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{POST:()=>l});var o=t(42706),i=t(28203),a=t(45994),n=t(39187),u=t(87328),c=t(85577);let p={messages:[]};async function l(e){let r=await (0,c.w)();try{if(!r)return n.NextResponse.json({message:"No Verify"},{status:400});{p.messages.push({role:u.N.roles.USER,content:e});let r=await u.N.chat(p.messages);return p.messages.push({role:u.N.roles.ASSISTANT,content:r.message.content}),n.NextResponse.json({content:{content:!0,message:r.message.content}},{status:200})}}catch(e){console.log("Error main",e.message)}}let d=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/lib/api/message/route",pathname:"/lib/api/message",filename:"route",bundlePath:"app/lib/api/message/route"},resolvedPagePath:"/home/asset/projects/almale/almale-next/src/app/lib/api/message/route.js",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:m,serverHooks:g}=d;function h(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:m})}},94268:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"7fbd57272dc24bc53f1a4d8788a4db7008736c6855":()=>s.$});var s=t(62370)},96487:()=>{},78335:()=>{},87328:(e,r,t)=>{"use strict";t.d(r,{N:()=>a});var s=t(29021),o=t(25380);class i{constructor(){this.roles={ASSISTANT:"assistant",USER:"user",SYSTEM:"system"},this.openai=new o.Ay({apiKey:process.env.OPENAI_API_KEY},{timeout:12e4})}async chat(e){try{return(await this.openai.chat.completions.create({messages:e,model:"gpt-3.5-turbo",store:!0})).choices[0]}catch(e){console.log("Error while chat",e.message)}}async transcription(e){try{if(!(0,s.existsSync)(e))throw Error(`File not found: ${e}`);let r=(0,s.createReadStream)(e);return(await this.openai.audio.transcriptions.create({file:r,model:"whisper-1"})).text}catch(e){throw console.error("Error during transcription:",e.message),console.error("Статус ошибки:",e.status),console.error("Full error:",e),Error("Transcription failed. Please check the logs for more details.")}}}let a=new i}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[5994,8410,4192,5452,3450,5380,5577],()=>t(68271));module.exports=s})();